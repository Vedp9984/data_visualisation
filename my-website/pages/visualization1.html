<!DOCTYPE html>
<html>
<head>
    <title>Competition Analysis</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
    background: #f0f2f5;
}

.container {
    max-width: 1000px;
    margin: 0 auto;
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.search-wrapper {
    margin: 20px 0;
    text-align: center;
}

#searchInput {
    width: 300px;
    padding: 10px 15px;
    border: 2px solid #ddd;
    border-radius: 20px;
    font-size: 16px;
    outline: none;
    transition: border-color 0.3s;
}

#searchInput:focus {
    border-color: #2196F3;
}

.bar {
    fill: #2196F3;
    transition: fill 0.3s;
}

.bar.highlight {
    fill: #1976D2;
}

.tooltip {
    position: absolute;
    padding: 10px;
    background: rgba(0,0,0,0.8);
    color: white;
    border-radius: 4px;
    pointer-events: none;
    font-size: 14px;
}
.back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            background: #2c3e50;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background 0.3s;
        }

        .back-button:hover {
            background: #34495e;
        }

    </style>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <a href="../index.html" class="back-button">Back to Home</a>
    <div class="container">
        <h1>Dog Breed Competition Analysis</h1>
        <div class="search-wrapper">
            <input type="text" id="searchInput" placeholder="Search for a breed...">
        </div>
        <div id="chartContainer"></div>
    </div>
    <script>
        // Load and process data
        d3.csv("data1.csv").then(data => {
            const margin = {top: 40, right: 20, bottom: 90, left: 60};
            const width = 960 - margin.left - margin.right;
            const height = 500 - margin.top - margin.bottom;

            // Create SVG container
            const svg = d3.select("#chartContainer")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);

            // Create tooltip
            const tooltip = d3.select("body").append("div")
                .attr("class", "tooltip")
                .style("opacity", 0);

            function updateChart(searchTerm) {
                // Filter data based on search
                const filteredData = data.filter(d => 
                    d.Breed.toLowerCase().includes(searchTerm.toLowerCase())
                );

                // Create scales
                const x = d3.scaleBand()
                    .range([0, width])
                    .padding(0.1);

                const y = d3.scaleLinear()
                    .range([height, 0]);

                // Update domains
                x.domain(filteredData.map(d => d["Class Name"]));
                y.domain([0, d3.max(filteredData, d => Number(d.Entries))]);

                // Clear previous chart
                svg.selectAll("*").remove();

                // Add X axis
                svg.append("g")
                    .attr("transform", `translate(0,${height})`)
                    .call(d3.axisBottom(x))
                    .selectAll("text")
                    .attr("transform", "rotate(-45)")
                    .style("text-anchor", "end");

                // Add Y axis
                svg.append("g")
                    .call(d3.axisLeft(y));

                // Add bars with animation
                svg.selectAll(".bar")
                    .data(filteredData)
                    .enter()
                    .append("rect")
                    .attr("class", "bar")
                    .attr("x", d => x(d["Class Name"]))
                    .attr("width", x.bandwidth())
                    .attr("y", height)
                    .attr("height", 0)
                    .transition()
                    .duration(750)
                    .attr("y", d => y(Number(d.Entries)))
                    .attr("height", d => height - y(Number(d.Entries)));

                // Add hover effects
                svg.selectAll(".bar")
                    .on("mouseover", function(event, d) {
                        d3.select(this).classed("highlight", true);
                        tooltip.transition()
                            .duration(200)
                            .style("opacity", .9);
                        tooltip.html(`Class: ${d["Class Name"]}<br/>Entries: ${d.Entries}`)
                            .style("left", (event.pageX + 10) + "px")
                            .style("top", (event.pageY - 28) + "px");
                    })
                    .on("mouseout", function() {
                        d3.select(this).classed("highlight", false);
                        tooltip.transition()
                            .duration(500)
                            .style("opacity", 0);
                    });
            }

            // Initialize chart
            updateChart("");

            // Add search functionality
            d3.select("#searchInput").on("input", function() {
                updateChart(this.value);
            });
        });
    </script>
</body>
</html>